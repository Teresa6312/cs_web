{% extends "main/base_site.html" %}
{% load i18n static %}



{% block title%}
    Update Profile | Qycs Global Shipping Inc. | English Official Website
{% endblock%}


{% block content %}
<div class="w3-cell w3-container w3-mobile" style="width:70%">
  {% if messages %}
  <ul class="messagelist">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}
  </ul>
  {% endif %}

  {% if receiverform.errors %}
  <ul class="messagelist">
      {% for message in receiverform.errors %}
      <li class="error" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}
  </ul>
  {% endif %}

  {% if form.errors %}
  <ul class="messagelist">
      {% for message in form.errors%}
      <li class="error" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}
  </ul>
  {% endif %}

  {% if itemset.errors %}
  <ul class="messagelist">
      {% for message in itemset.errors %}
      <li class="error" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}
  </ul>
  {% endif %}

  {% if imageset.errors %}
  <ul class="messagelist">
      {% for message in imageset.errors %}
      <li class="error" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}
  </ul>
  {% endif %}

    <div class="w3-card-2 w3-round w3-container w3-mobile">
          <form method="post" enctype="multipart/form-data">{% csrf_token %}
                {% block shippingset %} {% endblock%}

                <div class="w3-container w3-mobile">
                    <h2>Add Package:</h2>
                        <h4>From China:</h4>
                        <div class="w3-row">
                            <div class="w3-half w3-container">
                                Mailing Carriers: {{ form.cust_carrier }}
                            </div>
                            <div class="w3-half w3-container">
                                Tracking Number: {{form.cust_tracking_num}}
                            </div>
                        </div>
                        <div class="w3-container">
                        Package Note:<br/>{{ form.memo }}

                    {{form.low_volume_request}} Minimize your package&#39;s volume<br/>
                    {{form.no_rush_request}} No Rush Shipping (Double Points)
                    </div>
                </div>

                <div id="add_item_btn_row" class="w3-center w3-panel w3-mobile">
                  <button type="button" class="w3-third" id="add_snapshot_btn" onclick="AddSnapshotBlock()">Add Snapshot</button>
                    <div  class="w3-center w3-quarter">Or</div>
                  <button type="button" class="w3-third" id="add_item_btn" onclick="createItemsetBlock()">Add Items&#39; Detail</button>
                </div>
{{ itemset.management_form }}

                <div id="sub_btn_block" class="w3-mobile">
                    {% block extrabtn %}
                    {% endblock %}
                    <input type="submit" name="next" value="Save and add new package" />
                    <input type="submit" name="finish" value="Save"/>
                    <button type="button" onclick="clearForm(this)">Clear Form</button>
                </div>
            </form>
    </div>
</div>

{% endblock %}

{% block sidebar %}
<div class="w3-container w3-cell w3-mobile w3-rest">
    <div class="w3-card-2 w3-round w3-container aside-bar-background-color" style="overflow:auto; max-height:1000px;">
        <h3 >Packages</h3>
            {% if package_list %}
                {% for package in package_list %}
                <div class="w3-panel">
                    <h4 onclick="window.location.href='{{package.get_absolute_url}}'">{{ package.cust_tracking_num }} ({{ package.cust_carrier }})</h4>
                    {% if package.co_shipping %}
                        Co-shipping to:
                        {% if package.receiver.user %}
                            {{user.last_name}},{{user.first_name}}({{user.userprofile.phone}})
                        {% else %}
                            {{package.receiver.last_name}},{{package.receiver.first_name}}({{package.receiver.phone}})
                        {% endif %}
                        <br/>
                    {% elif not package.co_shipping %}
                        Direct Shipping to: {{package.ship_to_add}}<br/>
                    {% endif %}
                    {% if package.packageimage_set.all %}Inserted {{ package.packageimage_set.count}} package snapshot files<br/>{% endif %}
                    {% if package.item_set.all %}Entered {{ package.item_set.count}} Items' detail<br/>{% endif %}
                </div>
                {% endfor %}
            {% else %}
                <p>No package.</p>
            {% endif %}
    </div>
</div>
{% endblock %}


{% block script%}
<script src="{% static 'js/jquery.formset.js' %}"></script>
<script src="{% static 'js/packageset.js' %}"></script>

{% endblock%}
