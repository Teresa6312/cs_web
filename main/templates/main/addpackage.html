{% extends "main/base_site.html" %}
{% load i18n static %}



{% block title%}
    {% trans 'Add Package' %}
{% endblock%}

{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}" />
{% endblock %}

{% block messages %}
{% endblock messages %}

{% block content %}
<div class="w3-cell w3-container w3-mobile" style="max-width:500px; width:81%;">

    <div class="w3-card-2 w3-round w3-container w3-mobile">


      {% if messages %}
      <ul class="messagelist">{% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|capfirst }}</li>
      {% endfor %}</ul>
      {% endif %}
      {% if form.errors or receiverform.errors %}
          <p class="errornote">
          {% trans "Please correct the error(s) below." %}
          </p>
      {% endif %}

          <form method="post" enctype="multipart/form-data">{% csrf_token %}
                {% block shippingset %} {% endblock%}

                <fieldset class="module aligned w3-mobile">
                      <h2 class="w3-sand w3-text-indigo w3-large">{% trans 'Add Package' %}</h2>
                      <div class="form-row">
                        {{ form.wh_received.errors }}
                        {{ form.wh_received.label_tag }} {{ form.wh_received }}
                      </div>
                      <div class="form-row">
                        {{ form.cust_carrier.errors }}
                        {{ form.cust_carrier.label_tag }} {{ form.cust_carrier }}
                      </div>
                      <div class="form-row">
                        {{ form.cust_tracking_num.errors }}
                        {{ form.cust_tracking_num.label_tag }} {{ form.cust_tracking_num }}
                      </div>

                      <div class="form-row">
                        {{ form.memo.errors }}
                        {{ form.memo.label_tag }} {{ form.memo }}
                      </div>

                      <div class="form-row">
                        {{ form.low_volume_request.errors }}
                        {{ form.low_volume_request.label_tag }} {{ form.low_volume_request }}
                      </div>
                      {% if form.no_rush_request %}
                      <div class="form-row">
                        {{ form.no_rush_request.errors }}
                        {{ form.no_rush_request.label_tag }} {{ form.no_rush_request }}
                      </div>
                      {% endif %}
                </fieldset>


                <div id="add_item_btn_row" class="w3-center w3-panel w3-mobile">
                  <button type="button" class="w3-third" id="add_snapshot_btn" onclick="AddSnapshotBlock()">{% trans 'Add Snapshot' %}</button>
                    <div  class="w3-quarter">Or</div>
                  <button type="button" class="w3-third" id="add_item_btn" onclick="createItemsetBlock()">{% trans "Add Items' Detail" %}</button>
                </div>
                    {{ itemset.management_form }}
                <div id="sub_btn_block" class="submit-row">
                    {% block extrabtn %}
                    {% endblock %}
                    <button type="button" onclick="clearForm(this)">{% trans 'Clear Form' %}</button>
                    <input type="submit" name="next" value="{% trans 'Save and add new package' %}" />
                    <input type="submit" name="finish" value="{% trans 'Submit' %}"/>

                </div>
            </form>
    </div>
</div>

{% endblock %}

{% block sidebar %}
<div class="w3-container w3-cell w3-mobile w3-rest" style="min-width:400px;">
    <div class="w3-card-2 w3-round w3-container aside-bar-background-color" style="overflow:auto; max-height:1000px;">
        <h3>{% trans 'Packages' %}</h3>
            {% if package_list %}
                {% for package in package_list %}
                <div class="w3-panel">
                    <h4 onclick="window.location.href='{{package.get_absolute_url}}'">{{ package.cust_tracking_num }} ({{ package.cust_carrier }})</h4>
                    {% if package.co_shipping %}
                        {% trans 'Co-shipping to' %}: {{package.ship_to_col.name}}<br/>
                        {{package.receiver.last_name}},{{package.receiver.first_name}}({{package.receiver.phone}})<br/>
                    {% elif not package.co_shipping %}
                        Direct Shipping to: {{package.ship_to_add}}<br/>
                    {% endif %}
                    {% if package.packagesnapshot_set.all %}{% trans 'Inserted' %} {{ package.packagesnapshot_set.count}} {% trans 'package snapshots' %}<br/>{% endif %}
                    {% if package.item_set.all %}{% trans 'Entered' %} {{ package.item_set.count}} {% trans "Items' detail" %}<br/>{% endif %}
                </div>
                {% endfor %}
            {% else %}
                <p>{% if package.co_shipping %}{% trans 'No co-shipping packages in cart.' %}
                  {% else %}{% trans 'No direct shipping packages in cart.' %}{% endif %}
                </p>
            {% endif %}
    </div>
</div>
{% endblock %}


{% block script%}
<script src="{% static 'main/js/jquery.formset.js' %}"></script>
<script src="{% static 'main/js/packageset.js' %}"></script>

{% endblock%}
