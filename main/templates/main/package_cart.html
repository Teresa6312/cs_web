{% extends "main/base_site.html" %}
{% load i18n static %}

{% block title%}
{% trans 'Upcoming Packages' %}
{% endblock%}

{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}" />
{% endblock %}

{% block content %}
<form method = "post">
{% csrf_token %}
<div class="w3-cell w3-container w3-mobile" style="width:80%;">
    <div class="w3-card-2 w3-round w3-container">


		<h2>Packages Cart</h2>

		<button type="button" onclick="window.location.href = '{% url 'collection_points' %}'">{% trans 'Add Co-shipping Package' %}</button>
		<button type="button" onclick="window.location.href = '{% url 'add_direct_shipping' %}'">{% trans 'Add Direct Shipping Package' %}</button>

    <table class="w3-mobile">
        <thead>
            <tr><th class="w3-col w3-text-blue select_column">
              <input type="checkbox" id="select_all">&nbsp;{% trans 'Select All' %}
            </th><th style="width:100%;">{% trans 'Package' %}</th></tr>
        </thead>
        <tbody>
      {% if package_list %}
          {% for package in package_list %}
              <tr class="w3-cell-row"><td  class="w3-cell select_column">
                <input type="checkbox" name="package_set" value="{{package.id}}" id="id_package_set_{{ forloop.counter0 }}">
              </td><td class="w3-cell w3-rest">
                <div class="w3-card-2 w3-round w3-panel package">
                      <div class="w3-third w3-container">
                        <h5 class="cust_tracking_num">{{package.cust_tracking_num}}</h5>

                          {{package.cust_carrier}} ({{package.wh_received.country}})<br/>
                          {% if package.created_date %}
                          {% trans 'Created on' %}: {{package.created_date|date:"M d, Y" }}<br/>{% endif %}
                          {% if package.weight %}
                            {{package.weight}}(KG)<br/>{% endif %}
                    </div>
                  <div class="w3-third w3-container">

                    {% if package.ship_to_add %}
                    <h5>{% trans 'Direct Shipping to' %}:</h5>

                          {{package.ship_to_add.last_name}}, {{package.ship_to_add.first_name}}<br/>
                            {{package.ship_to_add.address}}<br/>
                            {% if package.ship_to_add.apt %}{{package.ship_to_add.apt}}<br/>{% endif %}
                            {{package.ship_to_add.city}}, {{package.ship_to_add.state}} {{package.ship_to_add.zipcode}}<br/>
                            {{package.ship_to_add.country}}<br/>



                    {% elif package.ship_to_col %}
                    <h5>{% trans 'Co-shipping to' %}:</h5>
                          {{package.ship_to_col.name}}<br/>
                              {{package.ship_to_col.address}}<br/>
                              {% if package.ship_to_col.apt %}{{package.ship_to_col.apt}}<br/>{% endif %}
                              {{package.ship_to_col.city}}, {{package.ship_to_col.state}} {{package.ship_to_col.zipcode}}<br/>
                              {{package.ship_to_col.country}}<br/>

                    {% endif %}

                  </div>

                  <div class="w3-third w3-container">
                        <h5>Price:</h5>
                        {% if package.order_amount %}
                          {% trans 'Order Amount' %}: {{package.currency}} <span id="order_amount_{{ forloop.counter0 }}" class="order_amount">{{package.order_amount}}</span><br/>
                        {% endif %}
                        {% if package.storage_fee %}
                          {% trans 'Storage fee' %}: {{package.currency}} <span id="storage_fee_{{ forloop.counter0 }}" class="storage_fee">{{package.storage_fee}}</span><br/>
                        {% endif %}
                        {% if package.shipping_fee %}
                          {% trans 'Shipping fee' %}: {{package.currency}} <span id="shipping_fee_{{ forloop.counter0 }}" class="shipping_fee">{{package.shipping_fee}}</span><br/>
                        {% endif %}
                        {% trans 'Total Amount' %}: {{package.currency}} <span id="total_amount_{{ forloop.counter0 }}" class="total_amount"></span><br/>

                  {% if package.issue %}<div class="errornote">{% trans 'There are some issue with your packages. Please check package detail.' %}</div>{% endif %}
                  <button type="button" class="w3-right" onclick="window.location.href='{{package.get_absolute_url}}'">detail</button>
                  </div>
                  </div>
              </td></tr>
          {% endfor %}
      {% endif %}
      <tbody>
    </table>
	</div>
</div>
<script src="{% static 'js/package_cart.js' %}"></script>
{% endblock %}

{% block sidebar %}
<div class="w3-container w3-cell w3-mobile" style="width:300px">
    <div class="w3-card-2 w3-round w3-container aside-bar-background-color">
        <h3>{% trans 'Place Packages' %}:</h3>
        <div id="selected_list">
        </div>
        <hr class="w3-border-grey"/>
          <div class="w3-row" id="coupon_block">{% trans 'Coupon' %}:<input type="hidden" name="coupon" id="id_coupon"><span class="w3-text-blue w3-right"  onclick="apply_coupon('{{ csrf_token }}','{% url 'coupon' %}')" id="apply_coupon">{% trans 'Apply' %}</span></div>
          <div class="w3-center">OR</div>
          <div class="w3-row" id="reward_block">{% trans 'Reward Points' %}:<input type="hidden" name="reward_point_used" id="id_reward_point_used"><span class="w3-text-blue w3-right" onclick="apply_reward({{user.reward}})">{% trans 'Apply' %}</span></div>
        <hr class="w3-border-black"/>
        <div id="amount_block">{% trans 'Total Amount' %}:<span class="w3-right" id="id_total_amount">0.00</span></div>
        <input type="submit" value="{% trans 'Submit' %}" class="w3-right">
    </div>
</div>
</form>
{% endblock %}
